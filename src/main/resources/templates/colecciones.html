<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/layout :: layout('Colecciones', ~{::link}, ~{::section})}">
<head>
    <link rel="stylesheet" th:href="@{/css/styles-colecciones.css}">
</head>
<body class="body-metamapa">
    <section>
        <main class="container py-5">
            <header class="mb-4 text-center">
                <h1 class="title-main" style="padding-top: 60px;">Colecciones</h1>
            </header>

            <!-- GRID de colecciones -->
            <section id="coleccionesList" class="mm-collections-grid">
                <article class="mm-collection-card" th:each="coleccion : ${colecciones}">
                    <div class="mm-card-header">
                        <img class="mm-card-icon" src="../components/sachet_7909215.png" alt="">
                        <div>
                            <h3 class="mm-card-title" th:text="${coleccion.titulo}"></h3>
                            <p class="mm-card-sub" th:text="${coleccion.descripcion != null ? coleccion.descripcion : 'Colecci칩n sin descripci칩n.' }"></p>
                        </div>
                    </div>

                    <ul class="mm-meta">
                        <th:block th:each="filtroFecha : ${coleccion.criterios}" th:if="${ filtroFecha.getTipo().equals('FECHACARGA') or filtroFecha.getTipo().equals('FECHAACONTECIMENTO')}" >
                                <li class="mm-chip">Desde: <span th:text="${ filtroFecha.fechaAcontecimientoInicial != null ? filtroFecha.fechaAcontecimientoInicial : (filtroFecha.fechaCargaInicial != null ? filtroFecha.fechaCargaInicial : filtroFecha.fechaCargaFinal)}"></span></li>
                                <li class="mm-chip">Hasta: <span th:text="${ filtroFecha.fechaAcontecimientoInicial != null ? filtroFecha.fechaAcontecimientoInicial : (filtroFecha.fechaCargaInicial != null ? filtroFecha.fechaCargaInicial : filtroFecha.fechaCargaFinal)}"></span></li>
                        </th:block>
                    </ul>

                    <ul class="mm-meta" style="margin-top:6px" >
                        <li class="mm-chip" th:each="filtroCategoria : ${coleccion.criterios}" th:if="${filtroCategoria.getTipo().equalsIgnoreCase('CATEGORIA')}" th:text="${filtroCategoria.categoria}"></li>
                    </ul>

                    <div class="accordion mm-accordion" th:id="${'acc-'+ coleccion.id}">
                        <div class="accordion-item">
                            <h2 class="accordion-header" th:id="${'h-' + coleccion.id}">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" th:data-bs-target="${'#c-'+coleccion.id}">
                                    Fuentes
                                </button>
                            </h2>
                            <div th:id="${'c-' + coleccion.id}" class="accordion-collapse collapse" th:aria-labelledby="${'h-' + coleccion.id}" th:data-bs-parent="${'#acc-' + coleccion.id}">
                                <div class="accordion-body">
                                    <ul class="mm-sources">
                                        <li th:each="fuente : ${coleccion.fuentes}">
                                            <span th:text="${fuente.tipoOrigen}"></span>
                                            <a class="mm-link" th:href="${fuente.url}" target="_blank" rel="noreferrer" th:text="${fuente.url}"></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mm-card-actions d-flex justify-content-between">
                        <a class="mm-btn mm-btn-primary" th:href="@{/colecciones/{id}/nav-hechos(id=${coleccion.getId()})}">Ver colecci칩n</a>
                        <a class="mm-btn mm-btn-ghost" href="#" th:attr="onclick=|accionCompartir( '${coleccion.titulo}', '${coleccion.getId()}' )|" >Compartir</a>
                    </div>
                </article>
            </section>
    <!--        <section id="coleccionesGrid" class="mm-collections-grid"></section>-->
        </main>

        <div class="d-flex justify-content-center flex-column align-items-center h-100">
            <a th:href="@{/index.html}">
                <a class="mm-btn mm-btn-primary btn-lg mb-3" style="font-weight: 500" aria-label="Volver al inicio" th:href="@{/main-gral}">Volver atr치s</a>
            </a>
        </div>


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>

        <script th:src="@{/js/colecciones.js}"></script>

    </section>
</body>
</html>